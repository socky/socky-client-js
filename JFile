# JBundle configuration file
# https://github.com/ismasan/jbundle

target_dir './dist'
src_dir './src'

version '0.5.0-coffee'

bundle 'socky.js' do
  license 'socky-licence.js'
  file 'socky.js'
end

bundle 'assets/flashfallback.js' do
  license 'socky-licence.js'
  license '../vendor/web-socket-js-licence.js'
  file '../vendor/web-socket-js/swfobject.js'
  file '../vendor/web-socket-js/web_socket.js'
end

bundle 'assets/json2.js' do
  license '../vendor/json-licence.js'
  file '../vendor/json/json2.js'
end

# Just copy this file across
file '../vendor/web-socket-js/WebSocketMainInsecure.swf' => 'assets/WebSocketMain.swf'

# Runs for every bundle and license source.
filter do |src, config|
  src = src.gsub /<VERSION>/, config.version.to_s
  src = src.gsub /<ASSETS_LOCATION>/, 'http://js.socky.org/v0.5-coffee/assets'
end

# some_dependency.js
filter :src do |src, config|
  src.gsub /<DEPENDENCY_SUFFIX>/, ''
end

# some_dependency.min.js
filter :min do |src, config|
  src.gsub /<DEPENDENCY_SUFFIX>/, '.min'
end